#! single-point DFT-CCSDT/sto-3g on water

print '        <<< Literal input to NWChem >>>'

nwchem {
memory 600 mb
geometry
O     0.000000000000    0.000000000000   -0.065638538099
H     0.000000000000   -0.757480611647    0.520865616174
H     0.000000000000    0.757480611647    0.520865616174
end

basis spherical
* library sto-3g
end

dft
 xc b3lyp
 grid lebedev 99 11
 convergence density 1.e-12
end

tce
 dft
 ccsdt
 thresh 1.e-12
end

task tce energy
}

energy('nwchem')

compare_values(-75.312570975611, get_variable('dft total energy'), 6, 'DFT')  #TEST
compare_values(-75.362576016574451, get_variable('ccsdt total energy'), 6, 'CCSDT')  #TEST
compare_values(-0.050005040963578, get_variable('ccsdt correlation energy'), 6, 'CCSDT corl')  #TEST

clean()
clean_variables()
nwchem {}

print '        <<< Translation of NWChem input to Psi4 format to NWChem >>>'

memory 600 mb

molecule {
O
H 1 R
H 1 R 2 A

R=0.958
A=104.5
}

set {
basis sto-3g
dft_spherical_points 302
dft_radial_points 99
reference rks #not necessary 
d_convergence 12
dft_functional b3lyp
nwchem_tce_thresh 1.0e-12
nwchem_tce_dft true
nwchem_tce ccsdt
}

nwchem {}

energy('nwchem-tce')

compare_values(-75.312570975611, get_variable('dft total energy'), 6, 'DFT')  #TEST
compare_values(-75.362576016574451, get_variable('ccsdt total energy'), 6, 'CCSDT')  #TEST
compare_values(-0.050005040963578, get_variable('ccsdt correlation energy'), 6, 'CCSDT corl')  #TEST

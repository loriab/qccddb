#! Geometry optimization HF/6-31g* on water
print '        <<< Literal nwchem input to NWChem >>>'

nwchem {
memory 400 mb 
geometry nocenter noautosym 
O     0.000000000000    0.000000000000   -0.065638538099
H     0.000000000000   -0.757480611647    0.520865616174
H     0.000000000000    0.757480611647    0.520865616174
symmetry c2v
end

basis 
* library 6-31g*
end

scf
 rhf
 thresh 1.0e-8 #Not the same as e_convergence and d_convergence
 direct #not necessary
end

task scf optimize
}

energy('nwchem')

compare_values(9.2885667731, get_variable('NUCLEAR REPULSION ENERGY'), 6, 'NRE')  #TEST
compare_values(-76.010746508402, get_variable('current energy'), 6, 'SCF')  #TEST

clean()
clean_variables()
nwchem {}  # clear literal block since running sequentially


print '        <<< Translation of nwchem.nw to Psi4 format to NWChem >>>'

memory 400 mb

molecule {
O     0.000000000000    0.000000000000   -0.065638538099
H     0.000000000000   -0.757480611647    0.520865616174
H     0.000000000000    0.757480611647    0.520865616174
symmetry c2v
}

set {
basis 6-31g*
nwchem_scf_thresh 1.0e-8 
nwchem_scf rhf 
}

#To get the same energy from Psi4, add commands below
set df_scf_guess false #Doing nothing for NWChem
set scf_type direct  
set g_convergence GAU #NWChem default convergence criteria 

nwchem {}  # clear literal block since running sequentially

optimize('nwchem-scf')

# Geometry optimization through NWChem gradient :
# Bond angle (105.5) and distance(0.947 angs) are matched to pure_nwchem(105.5, 0.947angs).

# NRE TEST against pure nwchem w/ default convergence criteria : 
compare_values(9.2885667731, get_variable('NUCLEAR REPULSION ENERGY'), 3, 'NRE') #TEST  
compare_values(-76.010746508402, get_variable('current energy'), 6, 'SCF')  #TEST
# NRE TEST against pure psi4 w/ g_convergence GAU: 
compare_values(9.2881366519376787, get_variable('NUCLEAR REPULSION ENERGY'), 5, 'NRE-pure_psi4') #TEST  
compare_values(-76.010746430558, get_variable('current energy'), 6, 'SCF-pure_psi4')  #TEST


clean()
clean_variables()
nwchem {}

